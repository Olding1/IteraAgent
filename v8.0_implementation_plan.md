

---

# Agent Zero v8.0 å®æ–½è®¡åˆ’ (ä¿®è®¢ç‰ˆ)

> **ç‰ˆæœ¬**: v8.0
> **ä»£å·**: Standard Library & Interface Guard
> **æ ¸å¿ƒå†³ç­–**: èšç„¦ LangChain Community æœ¬åœ°ç²¾é€‰åº“ï¼Œç§»é™¤ä¸ç¨³å®šçš„å¤–éƒ¨ API æœç´¢ã€‚

---

## ğŸ“‹ ç›®å½•

1. [æ€»è§ˆ](#æ€»è§ˆ)
2. [æ ¸å¿ƒåŠŸèƒ½](#æ ¸å¿ƒåŠŸèƒ½)
3. [æ¶æ„è®¾è®¡](#æ¶æ„è®¾è®¡)
4. [å®æ–½è·¯çº¿](#å®æ–½è·¯çº¿)
5. [è¯¦ç»†è®¾è®¡](#è¯¦ç»†è®¾è®¡)
6. [éªŒæ”¶æ ‡å‡†](#éªŒæ”¶æ ‡å‡†)

---

## ğŸ¯ æ€»è§ˆ

### ç‰ˆæœ¬å®šä½

Agent Zero v8.0 æ˜¯æ„å»º**â€œæ ‡å‡†å·¥å…·åº“â€**å’Œ**â€œå‚æ•°é˜²å¾¡ä½“ç³»â€**çš„é‡Œç¨‹ç¢‘ç‰ˆæœ¬ã€‚æˆ‘ä»¬å°†ä» LangChain Community ä¸­æç‚¼ç²¾åï¼Œæ„å»ºä¸€ä¸ªå†…ç½®çš„â€œåº”ç”¨å•†åº—â€ã€‚

### æ ¸å¿ƒç›®æ ‡

1.  **æœ¬åœ°å·¥å…·å‘ç° (Local Discovery)**: å»ºç«‹åŸºäº `langchain_community` çš„ç²¾é€‰å·¥å…·ç´¢å¼•ï¼Œæ”¯æŒè¯­ä¹‰æœç´¢ã€‚
2.  **Interface Guard**: åŸºäº Schema æœç»å‚æ•°å¹»è§‰ï¼Œç¡®ä¿å·¥å…·è°ƒç”¨ 100% æ­£ç¡®ã€‚

### å…³é”®æŒ‡æ ‡

| æŒ‡æ ‡ | v7.6 (å½“å‰) | v8.0 (ç›®æ ‡) | æå‡ |
| :--- | :--- | :--- | :--- |
| **å·¥å…·æ¥æº** | æ‰‹å†™/ç¡¬ç¼–ç  | **LangChain Community** (è‡ªåŠ¨ç´¢å¼•) | æ ‡å‡†åŒ– |
| **å·¥å…·æ•°é‡** | < 10 | **50+** (å¸¸ç”¨ç²¾é€‰é›†) | 5x |
| **å‘ç°å»¶è¿Ÿ** | N/A | **< 100ms** (æœ¬åœ°å‘é‡æ£€ç´¢) | æé€Ÿ |
| **å‚æ•°é”™è¯¯ç‡** | ~30% | **< 1%** (Guard æ‹¦æˆª) | 30x æ”¹å–„ |

---

## ğŸš€ æ ¸å¿ƒåŠŸèƒ½

### Feature 1: æ ‡å‡†åº“ç´¢å¼•ä¸å‘ç° (The Catalog)

#### åŠŸèƒ½æè¿°
ä¸å†å»äº’è”ç½‘æœç´¢ï¼Œè€Œæ˜¯é¢„å…ˆæ‰«æ `langchain_community`ï¼Œç”Ÿæˆä¸€ä»½ `tools_index.json`ï¼ˆåŒ…å«å·¥å…·åã€æè¿°ã€å®‰è£…åŒ…åã€Schemaï¼‰ã€‚è¿è¡Œæ—¶é€šè¿‡å‘é‡æ£€ç´¢åŒ¹é…ç”¨æˆ·éœ€æ±‚ã€‚

#### æ ¸å¿ƒæµç¨‹
1.  **æ„å»ºæ—¶ (Index Time)**: å¼€å‘è€…è¿è¡Œè„šæœ¬ï¼Œæ‰«æ `src/tools/definitions/` æˆ–ç¡¬ç¼–ç åˆ—è¡¨ï¼Œç”Ÿæˆ `index.json`ã€‚
2.  **è¿è¡Œæ—¶ (Runtime)**: ç”¨æˆ·è¾“å…¥éœ€æ±‚ -> æœ¬åœ°å‘é‡æœç´¢ `index.json` -> æ‰¾åˆ°åŒ¹é…å·¥å…· -> **uv åŠ¨æ€å®‰è£…ä¾èµ–**ã€‚

### Feature 2: Interface Guard (The Shield)

#### åŠŸèƒ½æè¿°
åœ¨ LLM ç”Ÿæˆå·¥å…·è°ƒç”¨å‚æ•°åï¼Œæ‰§è¡Œå·¥å…·å‰ï¼Œè¿›è¡Œä¸¥æ ¼çš„ Schema æ ¡éªŒã€‚

#### æ ¸å¿ƒæœºåˆ¶
*   **æ‹¦æˆª**: æ£€æŸ¥å‚æ•°ç±»å‹ã€å¿…å¡«é¡¹ã€‚
*   **è‡ªæ„ˆ**: å¦‚æœæ ¡éªŒå¤±è´¥ï¼Œå°†é”™è¯¯ä¿¡æ¯å›ä¼ ç»™ LLMï¼Œè®©å…¶é‡è¯•ï¼ˆSelf-Correctionï¼‰ã€‚

---

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### ç³»ç»Ÿæ¶æ„ (ç²¾ç®€ç‰ˆ)

```mermaid
graph TB
    User[ç”¨æˆ·éœ€æ±‚] --> Discovery[ToolDiscoveryEngine]
    
    subgraph "æ ¸å¿ƒèµ„äº§"
        Index[tools_index.json]
        Registry[LangChain Community]
    end
    
    Discovery -->|å‘é‡æ£€ç´¢| Index
    Index -->|æ˜ å°„| Registry
    
    Discovery -->|é€‰ä¸­å·¥å…·| Installer[ToolInstaller (uv)]
    Installer -->|å®‰è£…ä¾èµ–| Env[Agent Environment]
    
    LLM[Agent LLM] -->|ç”Ÿæˆå‚æ•°| Guard[Interface Guard]
    Guard -->|æ ¡éªŒå¤±è´¥| LLM
    Guard -->|æ ¡éªŒé€šè¿‡| Exec[Tool Executor]
```

### ç›®å½•ç»“æ„

```text
src/
â”œâ”€â”€ core/
â”‚   â”œâ”€â”€ tool_discovery.py       # ğŸ†• å·¥å…·å‘ç° (æœ¬åœ°å‘é‡æ£€ç´¢)
â”‚   â”œâ”€â”€ interface_guard.py      # ğŸ†• æ¥å£é˜²æŠ¤
â”‚   â””â”€â”€ ...
â”œâ”€â”€ tools/
â”‚   â”œâ”€â”€ index_builder.py        # ğŸ†• ç´¢å¼•ç”Ÿæˆè„šæœ¬ (å¼€å‘æ—¶è¿è¡Œ)
â”‚   â”œâ”€â”€ definitions.py          # ğŸ†• ç²¾é€‰å·¥å…·å®šä¹‰åˆ—è¡¨
â”‚   â””â”€â”€ data/
â”‚       â””â”€â”€ tools_index.json    # ğŸ†• ç”Ÿæˆçš„å·¥å…·ç›®å½•æ–‡ä»¶
â””â”€â”€ schemas/
    â””â”€â”€ tool_schema.py          # å·¥å…·å…ƒæ•°æ®å®šä¹‰
```

---

## ğŸ“… å®æ–½è·¯çº¿

ç”±äºç æ‰äº†å¤æ‚çš„å¤–éƒ¨ API é›†æˆï¼Œæ•´ä½“è¿›åº¦å°†å¤§å¹…åŠ å¿«ã€‚

### é˜¶æ®µåˆ’åˆ†

| é˜¶æ®µ | å‘¨æœŸ | æ ¸å¿ƒä»»åŠ¡ |
| :--- | :--- | :--- |
| **Phase 1: æ¥å£å«å£«** | Day 1-3 | å®ç° Interface Guardï¼ŒPydantic æ ¡éªŒï¼Œè‡ªåŠ¨ä¿®å¤å›è·¯ã€‚ |
| **Phase 2: ç´¢å¼•æ„å»º** | Day 4-5 | ç¼–å†™ `index_builder`ï¼Œæ•´ç† 20-50 ä¸ªå¸¸ç”¨ LangChain å·¥å…·ã€‚ |
| **Phase 3: å‘ç°å¼•æ“** | Day 6-7 | å®ç°åŸºäºå‘é‡çš„æœ¬åœ°æœç´¢ï¼Œå¯¹æ¥ v7.6 çš„ uv å®‰è£…å™¨ã€‚ |
| **Phase 4: é›†æˆæµ‹è¯•** | Day 8-9 | ç«¯åˆ°ç«¯æµ‹è¯•ï¼šéœ€æ±‚ -> æœåˆ°å·¥å…· -> è£…ä¾èµ– -> æ ¡éªŒ -> æ‰§è¡Œã€‚ |

---

## ğŸ“ è¯¦ç»†è®¾è®¡

### 1. å·¥å…·ç´¢å¼•å®šä¹‰ (The Schema)

è¿™æ˜¯ `tools_index.json` çš„ç»“æ„ï¼Œä¹Ÿæ˜¯æˆ‘ä»¬â€œè´§æ¶â€ä¸Šæ‘†çš„ä¸œè¥¿ã€‚

```python
# src/schemas/tool_schema.py

class ToolDefinition(BaseModel):
    """å·¥å…·å®šä¹‰å…ƒæ•°æ®"""
    id: str                  # e.g., "wikipedia_query"
    name: str                # e.g., "Wikipedia"
    description: str         # ç”¨äºå‘é‡æ£€ç´¢çš„è¯­ä¹‰æè¿°
    
    # å®‰è£…ä¿¡æ¯
    package_name: str        # pip åŒ…å, e.g., "wikipedia"
    import_path: str         # e.g., "langchain_community.tools.WikipediaQueryRun"
    
    # æ¥å£å®šä¹‰ (ç”¨äº Guard)
    args_schema: Dict[str, Any] # OpenAPI/JSON Schema
```

### 2. ç´¢å¼•æ„å»ºå™¨ (Index Builder)

æˆ‘ä»¬éœ€è¦ä¸€ä¸ªè„šæœ¬æ¥ç”Ÿæˆâ€œå•†åº—ç›®å½•â€ã€‚

```python
# src/tools/index_builder.py

# æ‰‹å·¥ç»´æŠ¤çš„ç²¾é€‰åˆ—è¡¨ (Curated List)
CURATED_TOOLS = [
    {
        "id": "search_duckduckgo",
        "name": "DuckDuckGo Search",
        "description": "è”ç½‘æœç´¢å·¥å…·ï¼Œç”¨äºæŸ¥è¯¢å®æ—¶ä¿¡æ¯ã€æ–°é—»ã€ç™¾ç§‘ç­‰ã€‚æ— éœ€API Keyã€‚",
        "package_name": "duckduckgo-search",
        "import_path": "langchain_community.tools.DuckDuckGoSearchRun"
    },
    {
        "id": "arxiv_search",
        "name": "Arxiv Search",
        "description": "å­¦æœ¯è®ºæ–‡æœç´¢å·¥å…·ï¼Œç”¨äºæŸ¥è¯¢ç‰©ç†ã€è®¡ç®—æœºç§‘å­¦ç­‰é¢†åŸŸçš„ç§‘ç ”è®ºæ–‡ã€‚",
        "package_name": "arxiv",
        "import_path": "langchain_community.tools.ArxivQueryRun"
    },
    # ... æ·»åŠ æ›´å¤š ...
]

def build_index():
    """ç”Ÿæˆ tools_index.json"""
    index = []
    for tool_def in CURATED_TOOLS:
        # å°è¯•åŠ¨æ€åŠ è½½ç±»ä»¥è·å–çœŸå®çš„ args_schema (å¦‚æœç¯å¢ƒé‡Œæœ‰çš„è¯)
        # æˆ–è€…ç›´æ¥ä½¿ç”¨é¢„å®šä¹‰çš„ schema
        # ...
        index.append(tool_def)
    
    save_json("src/tools/data/tools_index.json", index)
```

### 3. å·¥å…·å‘ç°å¼•æ“ (Discovery Engine)

```python
# src/core/tool_discovery.py

class ToolDiscoveryEngine:
    def __init__(self, builder_client):
        self.index_path = "src/tools/data/tools_index.json"
        self.tools = load_json(self.index_path)
        # åˆå§‹åŒ–å‘é‡æ•°æ®åº“ (ä½¿ç”¨è½»é‡çº§å†…å­˜ç‰ˆï¼Œå¦‚ Chroma æˆ– simple numpy)
        self.vector_db = self._init_vector_db(self.tools)

    async def search(self, query: str, top_k: int = 3):
        """
        æœ¬åœ°å‘é‡æœç´¢
        1. Embed(query)
        2. Cosine Similarity with Tool Descriptions
        3. Return top_k tools
        """
        return self.vector_db.similarity_search(query, k=top_k)
```

### 4. æ¥å£å«å£« (Interface Guard) - ä¿æŒåŸè®¾è®¡

```python
# src/core/interface_guard.py

class InterfaceGuard:
    def validate(self, tool_name, args, schema):
        # ä½¿ç”¨ Pydantic æˆ– jsonschema åº“è¿›è¡Œæ ¡éªŒ
        try:
            validate(instance=args, schema=schema)
            return True, None
        except ValidationError as e:
            return False, str(e) # è¿”å›é”™è¯¯ä¿¡æ¯ä¾› LLM è‡ªä¿®
```

---

## âœ… éªŒæ”¶æ ‡å‡†

### Phase 1: Interface Guard
- [ ] èƒ½å¤Ÿæ‹¦æˆªç¼ºå°‘çš„å¿…å¡«å‚æ•°ã€‚
- [ ] èƒ½å¤Ÿæ‹¦æˆªç±»å‹é”™è¯¯ï¼ˆå¦‚ `str` ä¼ äº† `int`ï¼‰ã€‚
- [ ] èƒ½å¤Ÿå°†é”™è¯¯åé¦ˆç»™ LLMï¼Œä¸” LLM åœ¨ä¸‹ä¸€æ¬¡å°è¯•ä¸­ä¿®æ­£å‚æ•°ã€‚

### Phase 2 & 3: Discovery & Install
- [ ] `tools_index.json` åŒ…å«è‡³å°‘ 10 ä¸ªå¸¸ç”¨å·¥å…· (Search, Wiki, Math, Shell, Fileç­‰)ã€‚
- [ ] è¾“å…¥ "æŸ¥ä¸€ä¸‹è¿™ç¯‡è®ºæ–‡"ï¼Œèƒ½æœåˆ° `Arxiv` å·¥å…·ã€‚
- [ ] é€‰ä¸­å·¥å…·åï¼Œè°ƒç”¨ v7.6 çš„ `EnvManager` (uv) æˆåŠŸå®‰è£… `arxiv` åŒ…ã€‚
- [ ] ç”Ÿæˆçš„ `agent.py` èƒ½æˆåŠŸ import å¹¶ä½¿ç”¨è¯¥å·¥å…·ã€‚

---

## ğŸ“Š æˆåŠŸæŒ‡æ ‡

1.  **å·¥å…·è¦†ç›–ç‡**ï¼šè¦†ç›– 80% çš„å¸¸è§ Demo éœ€æ±‚ï¼ˆæœç´¢ã€è®¡ç®—ã€æ–‡æ¡£ï¼‰ã€‚
2.  **æ„å»ºé€Ÿåº¦**ï¼šä»é€‰æ‹©å·¥å…·åˆ°å®‰è£…å®Œæˆï¼ˆuvç¼“å­˜å‘½ä¸­ä¸‹ï¼‰ < 5ç§’ã€‚
3.  **è¿è¡Œç¨³å®šæ€§**ï¼šå·¥å…·è°ƒç”¨å¯¼è‡´çš„ Runtime Error é™è‡³ 0ï¼ˆè¢« Guard æ‹¦æˆªï¼‰ã€‚

---

## ğŸ“ æ€»ç»“

è¿™ä»½ä¿®è®¢ç‰ˆçš„è®¡åˆ’**å‰”é™¤äº†æ‰€æœ‰é«˜é£é™©ã€ä¸å¯æ§çš„å¤–éƒ¨ä¾èµ–**ã€‚
*   å®ƒåˆ©ç”¨äº†ä½ ç°æœ‰çš„ä¼˜åŠ¿ï¼ˆv7.6 çš„ uv è®¾æ–½ï¼‰ã€‚
*   å®ƒè§„é¿äº†æœ€å¤§çš„å‘ï¼ˆHub APIï¼‰ã€‚
*   å®ƒæ„å»ºäº†ä¸€ä¸ªä½ å®Œå…¨å¯æ§çš„â€œç§æœ‰åº”ç”¨å•†åº—â€ã€‚

**è¿™æ˜¯æœ€å¿«è½åœ°ã€æœ€ç¨³å¥çš„ v8.0 è·¯å¾„ã€‚** å»ºè®®ç«‹å³æŒ‰æ­¤æ‰§è¡Œã€‚